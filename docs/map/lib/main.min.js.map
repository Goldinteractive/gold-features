{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap ffcbd56b12fd89bfa554","webpack:///./src/index.js","webpack:///external \"js-base\"","webpack:///./src/controls/geolocation.js"],"names":["cachedStyles","cachedIcons","Map","isResizing","isDraging","markers","currentMarker","initialZoom","parseInt","node","getAttribute","options","mapOptions","zoom","initialCenter","lat","parseFloat","lng","center","bounds","google","maps","LatLngBounds","infoWindow","InfoWindow","style","theme","styles","fetch","json","assetLocation","then","_loadMap","catch","ex","console","error","innerHTML","event","clearInstanceListeners","map","geolocationControl","success","position","setCenter","geolocationControlZoom","setZoom","message","listenerFirstIdle","addDomListenerOnce","_firstIdleListener","listenerIdle","addDomListener","_idleListener","forEach","marker","addMarker","boundMarkers","addBoundMarker","listenerZoomChanged","_zoomChangedListener","listenerDragstart","_dragstartListener","listenerDragend","_dragendListener","listenerResize","addEventListener","window","_resizeListener","cachedIcon","markerOptions","iconUrl","Object","assign","defaultMarkerOptions","pin","anchorPoint","icon","Promise","resolve","reject","_loadMarker","image","Image","onload","markerWidth","naturalWidth","markerHeight","naturalHeight","markerWidthScaled","scaleIcon","markerHeightScaled","Point","url","size","Size","scaledSize","anchor","origin","src","markerPromise","addBound","Marker","content","addListener","_markerClickListener","panTo","open","push","extend","fitBounds","updateCenter","trigger","responsive","resetOnResize","resetCenter","resetZoom","getCenter","pos","pan","one","setContent","close","getPosition","e","draging","fn","rAF","resize","bind","Feature","defaultOptions","assets","disableDefaultUI","scrollwheel","zoomControl","mapTypeControl","draggable","GeolocationControl","callback","navigator","geolocation","ControlPosition","RIGHT_BOTTOM","userLocation","getSavedUserLocation","$icon","document","createElement","className","$element","classList","toggle","appendChild","preventDefault","add","getUserLocation","remove","controls","display","location","sessionStorage","getItem","split","LatLng","cb","getCurrentPosition","coords","latitude","longitude","setItem","err"],"mappings":"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","file":"lib/main.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"js-base\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"feature-map\", [\"js-base\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"feature-map\"] = factory(require(\"js-base\"));\n\telse\n\t\troot[\"feature-map\"] = factory(root[\"js-base\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ffcbd56b12fd89bfa554","import { features } from '@goldinteractive/js-base'\nimport { utils, paths } from '@goldinteractive/js-base'\nimport GeolocationControl from './controls/geolocation'\n\nvar cachedStyles = {}\nvar cachedIcons = {}\n\nclass Map extends features.Feature {\n\n  init() {\n\n    this.isResizing = false\n    this.isDraging = false\n\n    this.markers = []\n    this.currentMarker = null\n\n    this.initialZoom = parseInt(this.node.getAttribute('data-zoom'), 10) || this.options.mapOptions.zoom\n    this.initialCenter = {\n      lat: parseFloat(this.node.getAttribute('data-lat')),\n      lng: parseFloat(this.node.getAttribute('data-lng'))\n    }\n\n    this.center = this.initialCenter\n    this.bounds = new google.maps.LatLngBounds()\n    this.infoWindow = new google.maps.InfoWindow()\n\n    this.options.mapOptions.zoom = this.initialZoom\n    this.options.mapOptions.center = this.initialCenter\n\n    var style = cachedStyles[this.options.theme] || null\n\n    if (!this.options.mapOptions.styles) {\n      if (!style) {\n        utils.fetch\n        .json(`${this.options.assetLocation}/styles/${this.options.theme}.json`)\n        .then((json) => {\n          // cache style\n          cachedStyles[this.options.theme] = json\n          // take styles for map and load it\n          this.options.mapOptions.styles = json\n          this._loadMap()\n        }).catch((ex) => {\n          console.error(`Loading map with theme \"${this.options.theme}\" failed`, ex)\n        })\n      } else {\n        this.options.mapOptions.styles = style\n      }\n    } else {\n      this._loadMap()\n    }\n  }\n\n  destroy() {\n    this.node.innerHTML = ''\n    google.maps.event.clearInstanceListeners(this.map)\n    this.map = null\n\n    super.destroy()\n  }\n\n  _loadMap() {\n    // create a map object and specify the DOM element for display.\n    this.map = new google.maps.Map(this.node, this.options.mapOptions)\n\n    if (this.options.geolocationControl) {\n      this.geolocationControl = new GeolocationControl(this.map, null, (success, position, error) => {\n        if (success) {\n          this.map.setCenter(position)\n          if (this.options.geolocationControlZoom) {\n            this.map.setZoom(this.options.geolocationControlZoom)\n          }\n        } else {\n          error = error.message || error\n          if (error != null) {\n            console.error(`Failed to detect user location: ${error}`)\n          } else {\n            console.error('Failed to detect user location')\n          }\n        }\n      })\n    }\n\n    this.listenerFirstIdle = google.maps.event.addDomListenerOnce(this.map, 'idle', this._firstIdleListener())\n    this.listenerIdle = google.maps.event.addDomListener(this.map, 'idle', this._idleListener())\n\n    this.options.markers.forEach((marker) => {\n      this.addMarker(marker)\n    })\n\n    this.options.boundMarkers.forEach((marker) => {\n      this.addBoundMarker(marker)\n    })\n\n    this.listenerZoomChanged = google.maps.event.addDomListener(this.map, 'zoom_changed', this._zoomChangedListener())\n    this.listenerDragstart = google.maps.event.addDomListener(this.map, 'dragstart', this._dragstartListener())\n    this.listenerDragend = google.maps.event.addDomListener(this.map, 'dragend', this._dragendListener())\n    this.listenerResize = this.addEventListener(window, 'resize', this._resizeListener())\n  }\n\n\n  /**\n   * Adds a marker to the map with a optional info window.\n   *\n   * @param   {Object} options - The marker options.\n   * @returns {Promise} Resolves when marker has loaded.\n   */\n  addMarker(options = {}) {\n    var cachedIcon\n    var markerOptions\n    var iconUrl\n\n    // extend Google API marker options\n    markerOptions = Object.assign({}, Map.defaultMarkerOptions.markerOptions, options.markerOptions || {})\n\n    // extend marker options\n    options = Object.assign({}, Map.defaultMarkerOptions, options)\n\n    // set map the marker belongs to\n    markerOptions.map = this.map\n\n    // set position to map center position if no position given\n    markerOptions.position = markerOptions.position || this.initialCenter\n\n    // set full icon url\n    iconUrl = `${this.options.assetLocation}/pins/${options.pin}.png`\n\n    cachedIcon = cachedIcons[iconUrl] || null\n\n    if (cachedIcon) {\n      markerOptions.anchorPoint = cachedIcon.anchorPoint\n      markerOptions.icon = cachedIcon.icon\n\n      return new Promise((resolve, reject) => {\n        var marker = this._loadMarker(markerOptions, options)\n        resolve(marker)\n      })\n    }\n\n    return new Promise((resolve, reject) => {\n      var image = new Image()\n\n      image.onload = () => {\n        var markerWidth = image.naturalWidth\n        var markerHeight = image.naturalHeight\n        var markerWidthScaled = markerWidth * options.scaleIcon\n        var markerHeightScaled = markerHeight * options.scaleIcon\n\n        markerOptions.anchorPoint = new google.maps.Point(0, markerHeightScaled / -1)\n\n        markerOptions.icon = {}\n        markerOptions.icon.url = iconUrl\n        markerOptions.icon.size = new google.maps.Size(markerWidthScaled, markerHeightScaled)\n        markerOptions.icon.scaledSize = new google.maps.Size(markerWidthScaled, markerHeightScaled)\n        markerOptions.icon.anchor = new google.maps.Point(markerWidthScaled / 2, markerHeightScaled)\n        markerOptions.icon.origin = new google.maps.Point(0, 0)\n\n        // cache icon data\n        cachedIcons[iconUrl] = {\n          anchorPoint: markerOptions.anchorPoint,\n          icon: markerOptions.icon\n        }\n\n        var marker = this._loadMarker(markerOptions, options)\n        resolve(marker)\n      }\n\n      image.src = iconUrl\n    })\n  }\n\n  /**\n   * Adds a marker to the map with its position as boundary.\n   *\n   * @param   {Object} options - The marker options.\n   * @returns {Promise} Resolves when marker has loaded.\n   */\n  addBoundMarker(options = {}) {\n    var markerPromise = this.addMarker(options)\n    return markerPromise.then((marker) => {\n      this.addBound(marker.position)\n    })\n  }\n\n  _loadMarker(markerOptions, options) {\n    var marker = new google.maps.Marker(markerOptions)\n\n    if (options.content) {\n      google.maps.event.addListener(\n        marker, 'click', this._markerClickListener(marker, options.content, options.panTo, options.open)\n      )\n    }\n\n    this.markers.push(marker)\n    return marker\n  }\n\n  /**\n   * Adds a new boundary.\n   * @param {Object} position - The boundary position.\n   */\n  addBound(position) {\n    // extend bounds with new marker position\n    this.bounds.extend(position)\n    // fit map according to current bounds\n    this.map.fitBounds(this.bounds)\n    // update center position\n    this.updateCenter()\n  }\n\n  resize() {\n    // trigger resize\n    google.maps.event.trigger(this.map, 'resize')\n\n    if (this.options.responsive && !this.options.resetOnResize) {\n      // preserve the current center point\n      this.map.setCenter(this.center)\n    }\n\n    if (this.options.resetOnResize) {\n      this.resetCenter(true)\n      this.resetZoom()\n    }\n\n    this.isResizing = false\n    this.trigger('resized')\n  }\n\n  updateCenter() {\n    this.center = this.map.getCenter()\n  }\n\n  setInitialCenter(pos) {\n    this.map.setCenter(pos)\n    this.initialCenter = pos\n  }\n\n  setInitialZoom(zoom) {\n    this.map.setZoom(zoom)\n    this.initialZoom = zoom\n  }\n\n  zoomIn() {\n    this.map.setZoom(++this.map.zoom)\n  }\n\n  zoomOut() {\n    this.map.setZoom(--this.map.zoom)\n  }\n\n  resetCenter(pan = false) {\n    if (pan) {\n      this.map.panTo(this.initialCenter)\n    } else {\n      this.map.setCenter(this.initialCenter)\n    }\n  }\n\n  resetZoom() {\n    this.map.setZoom(this.initialZoom)\n  }\n\n  _firstIdleListener() {\n    return () => {\n      this.trigger('firstIdle')\n    }\n  }\n\n  _markerClickListener(marker, content, pan, open) {\n    if (open) {\n      this.one('firstIdle', () => {\n        this.currentMarker = marker\n        this.infoWindow.setContent(content)\n        this.infoWindow.open(this.map, marker)\n      })\n    }\n\n    return () => {\n      if (this.currentMarker != marker) {\n        this.currentMarker = marker\n        this.infoWindow.setContent(content)\n        this.infoWindow.open(this.map, marker)\n      } else {\n        this.currentMarker = null\n        this.infoWindow.close()\n      }\n\n      if (pan) {\n        var pos = marker.getPosition()\n        this.map.panTo(pos)\n        this.center = pos\n      }\n    }\n  }\n\n  _idleListener() {\n    return (e) => {\n      if (!this.draging) {\n        this.updateCenter()\n      }\n\n      this.trigger('idle')\n    }\n  }\n\n  _zoomChangedListener() {\n    return (e) => {\n      this.trigger('zoomChanged')\n    }\n  }\n\n  _dragstartListener() {\n    return (e) => {\n      this.isDraging = true\n      this.trigger('dragstart')\n    }\n  }\n\n  _dragendListener() {\n    return (e) => {\n      this.isDraging = false\n      this.trigger('dragend')\n    }\n  }\n\n  _resizeListener() {\n    return (e) => {\n      if (!this.isResizing) {\n        this.isResizing = true\n        utils.fn.rAF(this.resize.bind(this))\n      }\n    }\n  }\n\n}\n\n/**\n * Default feature options.\n *\n * @type {Object}\n * @property {String} theme='default'\n *   Style theme used for map.\n * @property {Boolean} responsive=false\n *   Recenters map on resize.\n * @property {Boolean} resetOnResize=false\n *   Resets map to initial zoom and center on resize.\n * @property {Boolean} geolocationControl=false\n *   Adds a geolocation control.\n * @property {Number|null} geolocationControlZoom=null\n *   Zoom applied after geolocation click.\n * @property {Object} mapOptions\n *   Google Map API options for map instance.\n */\nMap.defaultOptions = {\n  theme: 'default',\n  assetLocation: `${paths.assets}/features/map`,\n  markers: [],\n  boundMarkers: [],\n  responsive: true,\n  resetOnResize: false,\n  geolocationControl: false,\n  geolocationControlZoom: null,\n  mapOptions: {\n    zoom: 12,\n    disableDefaultUI: true,\n    scrollwheel: false,\n    zoomControl: true,\n    mapTypeControl: false\n  }\n}\n\nMap.defaultMarkerOptions = {\n  open: false,\n  content: null,\n  panTo: false,\n  scaleIcon: 0.5,\n  pin: 'default',\n  markerOptions: {\n    draggable: false\n  }\n}\n\nexport default Map\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"js-base\"\n// module id = 1\n// module chunks = 0","export default class GeolocationControl {\n\n  constructor(map, position = null, callback = null) {\n    if (!navigator.geolocation) return\n\n    position = position || google.maps.ControlPosition.RIGHT_BOTTOM\n\n    this.userLocation = this.getSavedUserLocation()\n    this.map = map\n\n    this.$icon = document.createElement('div')\n    this.$icon.className = 'geolocation-control-icon'\n\n    this.$element = document.createElement('div')\n    this.$element.className = 'geolocation-control'\n    this.$element.classList.toggle('-active', !!this.userLocation)\n\n    this.$element.appendChild(this.$icon)\n\n    google.maps.event.addDomListener(this.$element, 'click', (e) => {\n      e.preventDefault()\n      this.$element.classList.add('-pending')\n\n      this.getUserLocation((success, position, error) => {\n        this.$element.classList.remove('-pending')\n\n        if (success) {\n          this.$element.classList.add('-active')\n        }\n\n        if (callback) {\n          callback(success, position, error)\n        }\n      })\n    }, false)\n\n    this.map.controls[position].push(this.$element)\n  }\n\n  hide() {\n    this.$element.style.display = 'none'\n  }\n\n  show() {\n    this.$element.style.display = 'block'\n  }\n\n  getSavedUserLocation() {\n    var location = window.sessionStorage.getItem('gmap-user-location')\n    if (!location) return null\n\n    var position = location.split(',')\n\n    return new google.maps.LatLng(\n      parseFloat(position[0]),\n      parseFloat(position[1])\n    )\n  }\n\n  getUserLocation(cb) {\n    if (this.userLocation) {\n      cb(true, this.userLocation, null)\n      return true\n    }\n\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition((geolocation) => {\n        let position = new google.maps.LatLng(\n          geolocation.coords.latitude, geolocation.coords.longitude\n        )\n\n        this.userLocation = position\n\n        window.sessionStorage.setItem(\n          'gmap-user-location', position.lat() +','+ position.lng()\n        )\n\n        cb(true, position)\n      }, (err) => {\n        cb(false, null, err)\n      })\n    } else {\n      cb(false, null, `Browser doesn't support geocoding`)\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/controls/geolocation.js"],"sourceRoot":""}